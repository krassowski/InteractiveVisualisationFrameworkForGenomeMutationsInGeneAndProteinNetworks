{% macro make_track(track, collapsed=False) %}
    <div class="track {{ track.class_name }} {{ 'hidden collapsible' if collapsed }}">
        <div class="elements">
        {%- if track.elements is string -%}
           {{ track.elements }}
        {%- else -%}
        {%- for element in track.elements -%}
            <div style="left:{{ element.start - 1 }}ch;width:{{ element.length }}ch" {% if element.description -%}
                title="{{ element.name }}"
                class="has-tooltip"
                data-content="{{ element.description }}"
              {%- endif -%}
              >{{ element.shown_name }}</div>
        {%- endfor -%}
        {%- endif -%}
        </div>
        <div class="subtracks">
        {% for subtrack in track.subtracks %}
          {{ make_track(subtrack, track.collapsed) }}
        {% endfor %}
        </div>
    </div>
{% endmacro %}

{% macro make_list(tracks, collapsed=False) %}
    <ul>
        {% for track in tracks %}
            {% if not track.inline %}
            <li class="{{ 'hidden collapsible' if collapsed }} {{ track.class_name }} {{ 'subtracks_collapsed' if track.collapsed }}" data-track="{{ track.class_name }}">
                {{ track.display_name | title | safe }}

                {% if track.subtracks %}
                    {{ make_list(track.subtracks, track.collapsed) }}
                {% endif %}
            </li>
            {% endif %}
        {% endfor %}
    </ul>
{% endmacro %}


<div class="tracks-box">
    <div class="controls">
        {# The controls have to be in the same containers as appropriate tracks #}

        <div class="input-group">
            <div class="input-group-btn">
                <button type="button" class="btn btn-default scroll-left">
                    <span class="glyphicon glyphicon-chevron-left"></span>
                </button>
                <button type="button" class="btn btn-default scroll-right">
                    <span class="glyphicon glyphicon-chevron-right"></span>
                </button>
                <button type="button" class="btn btn-default zoom-in">
                    <span class="glyphicon glyphicon-zoom-in"></span>
                </button>
                <button type="button" class="btn btn-default zoom-out">
                    <span class="glyphicon glyphicon-zoom-out"></span>
                </button>
            </div>
            <input class="form-control scroll-to-input" placeholder="Type a position, e.g. 105 or 100-200">
            <span class="input-group-addon">amino acids</span>
            <span class="input-group-btn">
              <button class="btn btn-default scroll-to" type="button">Go!</button>
            </span>
        </div><!-- /input-group -->

    </div>
    <div class="inner">
        <div class="description">
            {{ make_list(tracks) }}
        </div>
        <div class="tracks">
          <div class="scroll-area">
            <div class="scalable">
              {% for track in tracks %}
                {{ make_track(track) }}
              {% endfor %}
            </div>
          </div>
        </div>
    </div>
</div>
